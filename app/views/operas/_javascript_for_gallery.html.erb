<script type="text/javascript">
  $(window).resize(fix_image_height)
  fix_image_height()

  function fix_image_height(){
    if ( image_have_to_be_resized()) {
      console.log("RESIZO!")
      height_at_100_per_cent()      
    } else {
      $('img').css('height', 'auto')  
      $('img').css('min-width', '')  
    }
  }

  function image_have_to_be_resized(){
    return window_width_more_big_than_image() && $(window).width() > 750 && window_height_more_little_than_image()
  }

  function window_width_more_big_than_image(){
    return $(window).width() > $('img').width()
  }

  function window_height_more_little_than_image(){
    var image = new Image()
    image.src = $('img').attr('src')
    return $(window).height() < image.naturalHeight
  }


  function window_height_more_big_than_image(){
    var image = new Image()
    image.src = $('img').attr('src')
    console.log(image.naturalWidth)
    return $(window).width() > image.naturalWidth
  }


  function height_at_100_per_cent(){
    var img = $('img')
    var offset = img.offset();
    var altezza = $(window).height() - offset.top - 20
    if ($(window).height() < 400){
      altezza = 400 - offset.top - 20
    }
    $('img').css('height', altezza)  
  }


    function keydown_(e){
      var key = e.which||e.keyCode;
      switch(key){
        //left arrow
        case 37:
          document.getElementById("prev").click();
        break;
        //right arrow
        case 39:
          document.getElementById("next").click();
        break;
      }
    }

   document.addEventListener("keydown",function(e){
    console.log("CIAO")
    keydown_(e)
  })

</script>